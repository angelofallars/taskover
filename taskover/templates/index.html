{% extends "base.html" %}

{% block title %}Main{% endblock %}

{% if g.user %}
  {% block header %}Tasks for {{ g.user["username"] }}{% endblock %}
{% endif %}

{% block content %}
  {% if g.user %}
    <div class="task-list">
      <div class="task-list__actions">
        <a href="{{ url_for("routes.create_task") }}">Create Task</a>
      </div>

      {% for task in tasks %}
        <div class="task {% if task.is_completed == 1 %}task--completed{% endif %}">

          <div class="task__checkmark">
            {% if task.is_completed %}
              <i class="fas fa-check-circle"></i>
            {% else %}
              <i class="far fa-circle"></i>
            {% endif %}
          </div>

          <div class="task__content">
            <div class="task__content__title">{{ task.title }}</div>
            <div class="task__content__body">{{ task.body }}</div>
          </div>

          <div class="task__actions">
            <form action="{{ url_for("routes.toggle_task") }}" method="post">
              <input name="id" value="{{ task.id }}" type="hidden">

              {% if task.is_completed == 1 %}
                <input value="Mark as not done" type="submit">
              {% else %}
                <input value="Mark as done" type="submit">
              {% endif %}
            </form>

            <form action="{{ url_for("routes.update_task") }}" method="post">
              <input name="id" value="{{ task.id }}" type="hidden">
              <input name="update_db" value="no" type="hidden">
              <input value="Update" type="submit">
            </form>

            <form action="{{ url_for("routes.delete_task") }}" method="post">
              <input name="id" value="{{ task.id }}" type="hidden">
              <input value="Delete" type="submit">
            </form>
          </div>

        </div>
      {% endfor %}

    </div>
  {% endif %}
{% endblock %}
